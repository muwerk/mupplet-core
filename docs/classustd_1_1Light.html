<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>muwerk mupplet Core Library: ustd::Light Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">muwerk mupplet Core Library
   </div>
   <div id="projectbrief">muwerk applets; mupplets: functional units that support specific hardware or reusable applications</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceustd.html">ustd</a></li><li class="navelem"><a class="el" href="classustd_1_1Light.html">Light</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classustd_1_1Light-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">ustd::Light Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>mupplet-core GPIO <a class="el" href="classustd_1_1Light.html" title="mupplet-core GPIO Light class">Light</a> class  
 <a href="classustd_1_1Light.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="mup__light_8h_source.html">mup_light.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a21ad7ec9fcf2d3532c1ca2e75dad30fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classustd_1_1Light.html#a21ad7ec9fcf2d3532c1ca2e75dad30fe">Light</a> (String name, uint8_t port, bool activeLogic=false, uint8_t channel=0)</td></tr>
<tr class="separator:a21ad7ec9fcf2d3532c1ca2e75dad30fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a569ddce951a9b8c0fd56ed5bf3a5c57e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classustd_1_1Light.html#a569ddce951a9b8c0fd56ed5bf3a5c57e">begin</a> (Scheduler *_pSched, bool initialState=false)</td></tr>
<tr class="separator:a569ddce951a9b8c0fd56ed5bf3a5c57e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52180c7d7504d92b99dcd6289258fab1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classustd_1_1Light.html#a52180c7d7504d92b99dcd6289258fab1">set</a> (bool state)</td></tr>
<tr class="separator:a52180c7d7504d92b99dcd6289258fab1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace56172fd4aca81201f7ecbce17e9940"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classustd_1_1Light.html#ace56172fd4aca81201f7ecbce17e9940">setMode</a> (<a class="el" href="classustd_1_1LightController.html#abc85697ec510ff1488f56ffcdb974245">LightController::Mode</a> mode, unsigned int interval_ms=1000, double phase_unit=0.0, String pattern=&quot;&quot;)</td></tr>
<tr class="separator:ace56172fd4aca81201f7ecbce17e9940"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2548999ecfeffa8a893df7251c5c440f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classustd_1_1Light.html#a2548999ecfeffa8a893df7251c5c440f">setMinMaxWaveBrightness</a> (double minBrightness, double maxBrightness)</td></tr>
<tr class="separator:a2548999ecfeffa8a893df7251c5c440f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >mupplet-core GPIO <a class="el" href="classustd_1_1Light.html" title="mupplet-core GPIO Light class">Light</a> class </p>
<p >The GPIO <a class="el" href="classustd_1_1Light.html" title="mupplet-core GPIO Light class">Light</a> class allows control of standard Leds (or lights) with digital and PWM control.</p>
<p >Supported modes are: on/off (mode: Passive), brightness (mode: Passive, with PWM), wave (soft oszillation, mode: Wave), one-time pulse (mode: Pulse), and repeating, user-selectable patterns (mode: Pattern).</p>
<h2>Messages</h2>
<p >As all light mupplets, the mupplet can be controlled using the standard light messages:</p>
<h3><a class="el" href="classustd_1_1Light.html" title="mupplet-core GPIO Light class">Light</a> Related Messages sent by Mupplet:</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">topic   </th><th class="markdownTableHeadNone">message body   </th><th class="markdownTableHeadNone">comment    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>&lt;mupplet-name&gt;/light/unitbrightness</code>   </td><td class="markdownTableBodyNone">normalized brightness [0.0-1.0]   </td><td class="markdownTableBodyNone"><code>0.34</code>: Float value encoded as string. Not send on automatic changes (e.g. pulse mode)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>&lt;mupplet-name&gt;/light/state</code>   </td><td class="markdownTableBodyNone"><code>on</code> or <code>off</code>   </td><td class="markdownTableBodyNone">current led state (<code>on</code> is not sent on pwm intermediate values)   </td></tr>
</table>
<h3><a class="el" href="classustd_1_1Light.html" title="mupplet-core GPIO Light class">Light</a> Related Messages received by Mupplet:</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">topic   </th><th class="markdownTableHeadNone">message body   </th><th class="markdownTableHeadNone">comment    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>&lt;mupplet-name&gt;/light/set</code>   </td><td class="markdownTableBodyNone"><code>on</code>, <code>off</code>, <code>true</code>, <code>false</code>, <code>pct 34</code>, <code>34%</code>, <code>0.34</code>   </td><td class="markdownTableBodyNone">Led can be set fully on or off with on/true and off/false. A fractional brightness of 0.34 (within interval [0.0, 1.0]) can be sent as either <code>pct 34</code>, or <code>0.34</code>, or <code>34%</code>.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>&lt;mupplet-name&gt;/light/mode/set</code>   </td><td class="markdownTableBodyNone"><code>passive</code>, <code>pulse &lt;duration_ms&gt;</code>, <code>blink &lt;intervall_ms&gt;[,&lt;phase-shift&gt;]</code>, <code>pattern &lt;pattern&gt;[,&lt;intervall&gt;[,&lt;phase&gt;]]</code> or <code>wave &lt;intervall_ms&gt;[,&lt;phase-shift&gt;]</code>   </td><td class="markdownTableBodyNone">Mode passive does no automatic led state changes, <code>pulse</code> switches the led on for <code>&lt;duration_ms&gt;</code> ms, then led goes back to passive mode. <code>blink</code> changes the led state very <code>interval_ms</code> on/off, <code>wave</code> uses pwm to for soft changes between on and off states. Optional comma-speratated phase [0.0, ..., 1.0] can be added as a phase-shift. Two leds, one with <code>wave 1000</code> and one with <code>wave 1000,0.5</code> blink inverse. Patterns can be specified as string containing <code>+</code>,<code>-</code>,<code>0</code>..<code>9</code> or <code>r</code>. <code>+</code> is led on during <code>&lt;intervall&gt;</code> ms, <code>-</code> is off, <code>0</code>..<code>9</code> brightness-level. An <code>r</code> at the end of the pattern repeats the pattern. <code>"pattern +-+-+-+++-+++-+++-+-+-+---r,100"</code> lets the board signal SOS.   </td></tr>
</table>
<h2>Sample Led Integration</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#define __ESP__ 1   </span><span class="comment">// Platform defines required, see ustd library doc, mainpage.</span></div>
<div class="line"><span class="preprocessor">#include &quot;scheduler.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;mup_light.h&quot;</span></div>
<div class="line"> </div>
<div class="line">ustd::Scheduler sched;</div>
<div class="line">ust::Light led(<span class="stringliteral">&quot;myled&quot;</span>,13);</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup() {</div>
<div class="line">    led.begin(&amp;sched);</div>
<div class="line">}</div>
</div><!-- fragment --><p >More information: <a href="https://github.com/muwerk/mupplet-core/blob/master/extras/led-notes.md">Led application notes</a> </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a21ad7ec9fcf2d3532c1ca2e75dad30fe" name="a21ad7ec9fcf2d3532c1ca2e75dad30fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21ad7ec9fcf2d3532c1ca2e75dad30fe">&#9670;&#160;</a></span>Light()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">ustd::Light::Light </td>
          <td>(</td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>activeLogic</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>channel</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Instantiate a GPIO Led object at a given hardware port.</p>
<p >No hardware interaction is performed, until <a class="el" href="classustd_1_1Light.html#a569ddce951a9b8c0fd56ed5bf3a5c57e">begin()</a> is called.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">name</td><td>Name of the led, used to reference it by pub/sub messages </td></tr>
    <tr><td class="paramname">port</td><td>GPIO port number, needs to be a PWM enabled pin, if brightness, Pulse-mode or Pattern-mode with brightness levels are used. </td></tr>
    <tr><td class="paramname">activeLogic</td><td>Characterizes the pysical logicl-level which would turn the led on. Default is 'false', which assumes the led turns on if logic level at the GPIO port is LOW. Change to 'true', if led is turned on by physical logic level HIGH. </td></tr>
    <tr><td class="paramname">channel</td><td>currently ESP32 only, can be ignored for all other platforms. ESP32 requires assignment of a system-wide unique channel number (0..15) for each led in the system. So for ESP32 both the GPIO port number and a unique channel id are required.</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a569ddce951a9b8c0fd56ed5bf3a5c57e" name="a569ddce951a9b8c0fd56ed5bf3a5c57e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a569ddce951a9b8c0fd56ed5bf3a5c57e">&#9670;&#160;</a></span>begin()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ustd::Light::begin </td>
          <td>(</td>
          <td class="paramtype">Scheduler *&#160;</td>
          <td class="paramname"><em>_pSched</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>initialState</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Initialize GPIO hardware and start operation</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">_pSched</td><td>Pointer to a muwerk scheduler object, used to create worker tasks and for message pub/sub. </td></tr>
    <tr><td class="paramname">initialState</td><td>Initial logical state of the light: false=off, true=on. Note that this is independent of the physical output signal on the GPIO port: if a LOW or HIGH signal is required to switch the light on, is defined by the constructor's <code>activeLogic</code> parameter. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a52180c7d7504d92b99dcd6289258fab1" name="a52180c7d7504d92b99dcd6289258fab1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52180c7d7504d92b99dcd6289258fab1">&#9670;&#160;</a></span>set()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ustd::Light::set </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Set light to a given logical state. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>State of the light: true=on, false=off. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a2548999ecfeffa8a893df7251c5c440f" name="a2548999ecfeffa8a893df7251c5c440f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2548999ecfeffa8a893df7251c5c440f">&#9670;&#160;</a></span>setMinMaxWaveBrightness()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ustd::Light::setMinMaxWaveBrightness </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>minBrightness</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxBrightness</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Set minimum and maximum brightness in wave <a class="el" href="classustd_1_1LightController.html#abc85697ec510ff1488f56ffcdb974245">LightController::Mode</a></p>
<p >Useful to compensate, if a light stays at similar brightness for a range of input values.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">minBrightness</td><td>Minimum brightness 0-1.0 </td></tr>
    <tr><td class="paramname">maxBrightness</td><td>Maximum brightness 0-1.0 </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ace56172fd4aca81201f7ecbce17e9940" name="ace56172fd4aca81201f7ecbce17e9940"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace56172fd4aca81201f7ecbce17e9940">&#9670;&#160;</a></span>setMode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ustd::Light::setMode </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classustd_1_1LightController.html#abc85697ec510ff1488f56ffcdb974245">LightController::Mode</a>&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>interval_ms</em> = <code>1000</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phase_unit</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">String&#160;</td>
          <td class="paramname"><em>pattern</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p >Set light mode to given <a class="el" href="classustd_1_1LightController.html#abc85697ec510ff1488f56ffcdb974245">LightController::Mode</a> </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mode</td><td><a class="el" href="classustd_1_1Light.html" title="mupplet-core GPIO Light class">Light</a> <a class="el" href="classustd_1_1LightController.html#abc85697ec510ff1488f56ffcdb974245">LightController::Mode</a> </td></tr>
    <tr><td class="paramname">interval_ms</td><td>Duration of blink in Mode::Blink or pulse duration. </td></tr>
    <tr><td class="paramname">phase_unit</td><td>Phase difference used to synchronize different lights in Wave or blink mode. A phase_unit of 0 synchronizes the given lights. phase-difference is in [0.0-1.0]. A phase difference of 0.5 (180 degrees) between two lights would let lights blink reversed. </td></tr>
    <tr><td class="paramname">pattern</td><td>Only in Mode::Pattern: a pattern string consisting of the characters '+' (on), '-' (off), '0'-'9' (brightness 0%-100%), or at the end of the string 'r' for endless repeat. Intervall_ms is the time for each pattern step. Example "++-r" with intervall_ms=100 lights the led for 200ms on, 100ms off and repeats. "1---------r" makes a faint 100ms flash every second. "0135797531r" simulates a PWM wave. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/<a class="el" href="mup__light_8h_source.html">mup_light.h</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
